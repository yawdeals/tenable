# Tenable.io API credentials (REQUIRED)
TENABLE_ACCESS_KEY=your_tenable_access_key_here
TENABLE_SECRET_KEY=your_tenable_secret_key_here
TENABLE_URL=https://cloud.tenable.com

# Cribl HEC endpoint (REQUIRED)
CRIBL_HEC_HOST=your_cribl_host_here
CRIBL_HEC_PORT=8088
CRIBL_HEC_TOKEN=your_cribl_hec_token_here
CRIBL_HEC_SSL_VERIFY=true

# Path to CA certificate file for SSL verification (optional)
# Leave empty or comment out to use system CA bundle
# CRIBL_HEC_CA_CERT=/path/to/ca-certificate.pem

# HEC retry configuration
HEC_MAX_RETRIES=3
HEC_BACKOFF_FACTOR=1.0

# HEC connection pool tuning (reduced to avoid overwhelming HEC)
HEC_POOL_CONNECTIONS=3
HEC_POOL_MAXSIZE=3

# HEC rate limiting (prevents socket closures and request errors)
# Delay in seconds between batch sends (0.2 = 200ms recommended)
HEC_BATCH_DELAY=0.2
# Request timeout in seconds (increase for slow networks)
HEC_REQUEST_TIMEOUT=90

# Events per HEC batch (5000 recommended for stability)
HEC_BATCH_SIZE=5000

# Max events per feed (0=unlimited)
MAX_EVENTS_PER_FEED=0


# Concurrent feeds (1 = sequential, safest for HEC)
# Increase to 2-3 only if sequential works without errors
MAX_CONCURRENT_FEEDS=1

# Smart feed grouping (recommended: true)
# Groups feeds by Tenable API type to avoid 429 errors:
#   - Asset feeds run sequentially (only 1 asset export allowed at a time)
#   - Vulnerability feeds run sequentially (only 1 vuln export allowed at a time)
#   - REST API feeds (plugin, compliance) run sequentially
#   - BUT different groups run IN PARALLEL (up to 3 concurrent streams)
SMART_FEED_GROUPING=true

# Checkpoint directory
CHECKPOINT_DIR=checkpoints
CHECKPOINT_MAX_IDS=100000
CHECKPOINT_RETENTION_DAYS=30

# Hours between deleted asset scans (168=weekly recommended)
DELETED_ASSET_SCAN_INTERVAL_HOURS=168

# Logging level (DEBUG, INFO, WARNING, ERROR)
LOG_LEVEL=INFO

# Daemon mode interval in seconds (21600=6 hours)
SCAN_INTERVAL=21600


# Delay between feeds in same group (seconds)
# Gives Tenable time to release export locks (30s recommended)
INTER_FEED_DELAY=30

# Fully sequential mode (recommended if getting 429 errors)
# When true: ALL feeds run one at a time, no parallelism
# When false: Uses smart grouping (groups run in parallel)
FULLY_SEQUENTIAL=true
